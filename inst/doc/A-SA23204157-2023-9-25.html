<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="丁婧琦" />

<meta name="date" content="2023-09-25" />

<title>Homework-2023.09.25</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework-2023.09.25</h1>
<h4 class="author">丁婧琦</h4>
<h4 class="date">2023-09-25</h4>



<div id="question" class="section level2">
<h2>Question</h2>
<p><br />
<strong>5.6:In Example 5.7 the control variate approach was illustrated
for Monte Carlo integration of <span class="math display">\[θ=\int_{0}^{1} e^xdx.\]</span>Now consider the
antithetic variate approach. Compute Cov(<span class="math inline">\(e^U\)</span> , <span class="math inline">\(e^{1−U}\)</span> ) and Var(<span class="math inline">\(e^U\)</span> + <span class="math inline">\(e^{1−U}\)</span>), where U ∼ Uniform(0,1). What is
the percent reduction invariance of <span class="math inline">\(\hat{θ}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</strong><br />
## Answer<br />
由题可知，对偶变量为<span class="math inline">\(1-U\)</span>,由于 U ∼
Uniform(0,1)，因此1-U ∼ Uniform(0,1)。可得Var(<span class="math inline">\(e^U\)</span> + <span class="math inline">\(e^{1−U}\)</span>)为： <span class="math display">\[Var((e^U+e^{1-U})/2)=Var(e^U)/4+Var(e^{1-U})/4+Cov(e^U,e^{1-U})/2\]</span>
其中，<span class="math inline">\(Var(e^U)=Var(e^{1-U})\)</span>,因此可得：<span class="math display">\[Var(e^U)=E(e^{2U})-(E(e^U))^2=\int_0^1
e^{2x}dx-(\int_0^1e^{x}dx)^2=0.2420\]</span> <span class="math display">\[Cov(e^U,e^{1-U})=E(e^{U+1-U)})-E(e^U)E(e^{1-U})=e-\int_0^1e^xdx
\int_0^1e^{1-x}dx=-0.2342\]</span> 所以<span class="math display">\[Var((e^U+e^{1-U})/2)=0.0039\]</span><br />
因此，可以得出用对偶变量法比用普通的MC方法估计所减少的方差为<span class="math display">\[1-Var((e^U+e^{1-U})/2)/Var(e^U)=1-0.0039/0.2420=98.39\%\]</span><br />
## Question<br />
<strong>5.7:Refer to Exercise 5.6. Use a Monte Carlo simulation to
estimate θ by the antithetic variate approach and by the simple Monte
Carlo method. Compute an empirical estimate of the percent reduction in
variance using the antithetic variate. Compare the result with the
theoretical value from Exercise 5.6.</strong><br />
## Answer<br />
1.采用蒙特卡罗模拟的方法来估算<span class="math inline">\(\hat{\theta}\)</span>,蒙特卡罗模拟的计算原理如下：
<span class="math display">\[\hat{\theta}_1 = \frac
1m\sum\limits_{i=1}^{m}e^{X_{i}},\quad X_{i}\sim U(0,1).\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">2e5</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>theta_hat_1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(x1)</span></code></pre></div>
<p>2.采用对偶变量法来估算<span class="math inline">\(\hat{\theta}\)</span>，对偶变量估计的计算原理如下：
<span class="math display">\[\hat\theta_2 =
\frac{1}{m}\sum\limits_{i=1}^{m/2}(e^{X_{i}}+e^{1-X_{i}}),\quad
X_{i}\sim U(0,1).\]</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">2e5</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m);</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>theta_hat_2 <span class="ot">&lt;-</span> (<span class="fu">exp</span>(x2) <span class="sc">+</span> <span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x2)) <span class="sc">/</span> <span class="dv">2</span></span></code></pre></div>
<p>用对偶变量进行估算与蒙特卡罗模拟进行计算，估算方差减少的百分比如下：</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">var</span>(theta_hat_2) <span class="sc">/</span> <span class="fu">var</span>(theta_hat_1)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] 0.9838564</code></pre>
<p>0.0.9838564与5.6中理论计算出的减小的方差百分比 <span class="math inline">\(1-0.0039/0.2420=98.39\%\)</span>
相差很小,说明理论计算出的和计算机运行的方差减少百分比没有较大区别。<br />
## Question<br />
<strong>习题1：Proof that what value ρ = <span class="math inline">\(\frac ld\)</span>should take to minimize the
asymptotic variance of <span class="math inline">\(\hat{\pi}\)</span>?
(m ∼ B(n, p),using δ method)</strong><br />
## Answer<br />
方法是基于泰勒展开式，用近似的方法求随机变量函数的方差的一种方法。对于随机变量<span class="math inline">\(Y=Y(x)\)</span>,它的方差近似为D(Y) ≈ <span class="math inline">\([Y′(µ)]^2σ^2.\)</span><br />
由蒲丰投针可知， π 的一个估计可以通过计算<span class="math inline">\(\frac nm =\frac
{2l}{dπ}\)</span>得出，其中m为试验次数，n为相交次数。可以得出<span class="math inline">\(\hat{\pi}\)</span>的表达式为：<span class="math display">\[\hat{\pi}=\frac {2mρ}{n}\]</span> 用<span class="math inline">\(\delta\)</span>方法求<span class="math inline">\(\hat{\pi}\)</span>的渐进方差。<br />
假设ρ为定值，由于n∼B(m,p)，根据蒲丰投针的原理<span class="math inline">\(p=\frac {2ρ}{\pi}\)</span>。 因此<span class="math display">\[E(n)=np=\frac {2ρm}{\pi}\]</span>,<span class="math display">\[D(n)=mp(1-p)=\frac
{2ρm}{\pi}(1-\frac{2ρ}{\pi})\]</span> 由<span class="math inline">\(\delta\)</span>方法可求解<span class="math inline">\(\hat{\pi}\)</span>的渐进方差<span class="math inline">\(D(\hat{\pi})\)</span>的公式如下：<span class="math display">\[D(\hat{\pi})=(\frac {2ρm}{(mp)^2})^2D(n)=(\frac
{2ρ}{mp^2})^2\frac
{2ρm}{\pi}(1-\frac{2ρ}{\pi})=\frac{\pi^3-2ρ\pi^2}{2mρ}\]</span>
此时，可将<span class="math inline">\(D(\hat{\pi})\)</span>的表达式中的ρ看成是变量，对其求导可得：<span class="math display">\[\frac
{dD(\hat{\pi})}{dρ}=-\frac{\piρ^3}{2mρ^2}\]</span>，因此可知<span class="math inline">\(D(\hat{\pi})\)</span>的一阶导数小于0，说明<span class="math inline">\(D(\hat{\pi})\)</span>是单调低减的。因此，<span class="math inline">\(D(\hat{\pi})\)</span>的极值在ρ的边界上取得，即ρ=1时使得渐进方差最小。<br />
## Question<br />
<strong>习题2：Take three different values of ρ (<span class="math inline">\(0 \le ρ \le 1\)</span>, including <span class="math inline">\(ρ_{min}\)</span>) and use Monte Carlo simulation
to verify your answer. (n = <span class="math inline">\(10^6\)</span>,
Number of repeated simulations K = 100)</strong><br />
## Answer<br />
根据<span class="math inline">\(ρ_{min}=1\)</span>，选取<span class="math inline">\(ρ_1=0.3，ρ_2=0.6\)</span>，利用蒙特卡罗的方法对其进行模拟：</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">#编写一个函数来求不同ρ下的方差，这里不妨设d=1</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>my.simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>l <span class="ot">&lt;-</span> a</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>d<span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>k<span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>pihat<span class="ot">&lt;-</span><span class="fu">numeric</span>(k)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="cf">while</span>(j<span class="sc">&lt;=</span>k)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>{X <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>pihat[j] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>j <span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>}</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">var</span>(pihat))</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>}</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="do">##求ρ=0.3、0.6和1的情况</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="fu">my.simulation</span>(<span class="fl">0.3</span>)</span></code></pre></div>
<pre><code>## [1] 5.299701e-05</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">my.simulation</span>(<span class="fl">0.6</span>)</span></code></pre></div>
<pre><code>## [1] 1.317689e-05</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">my.simulation</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 6.612878e-06</code></pre>
<p>从模拟的结果可以看出，当ρ=1，比ρ=0.3和ρ=0.6，它的渐进方差更小。这也与习题1中的<span class="math inline">\(ρ_{min}=1\)</span>的结论相符合。</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
